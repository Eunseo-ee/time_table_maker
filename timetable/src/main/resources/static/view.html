<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="header.css" />
    <link rel="stylesheet" href="table.css" />
    <title>에브리타임</title>
    <link rel="icon" href="https://play-lh.googleusercontent.com/0oDBGRaLXdz92kZGHpCNts6KQUr38rG4uCTrV8_32WEyMy70tzC5CM5KbPk3yFoVrwM"/>
</head>
<body>

<header>
    <div class="container">

        <div class="logo">
            <img
                    src="https://play-lh.googleusercontent.com/0oDBGRaLXdz92kZGHpCNts6KQUr38rG4uCTrV8_32WEyMy70tzC5CM5KbPk3yFoVrwM"
            />
            <p>
                <span>에브리타임</span>
                <span>서울과기대</span>
            </p>
        </div>

        <div class="menu">
            <ul>
                <li><a href="/">게시판</a></li>
                <li>
                    <a href="https://web-develop-uxcio.run.goorm.site/Web_develop/EVERYTIMECLONE/HTML.html">시간표</a>
                </li>
                <li><a href="/">강의실</a></li>
                <li><a href="/">학점계산기</a></li>
                <li><a href="/">친구</a></li>
                <li><a href="/">책방</a></li>
                <li><a href="/">캠퍼스픽</a></li>
            </ul>
        </div>
        <div class="icon">
            <img src="https://cdn-icons-png.flaticon.com/512/1159/1159740.png" />
            <img src="https://cdn-icons-png.flaticon.com/512/66/66933.png" />
        </div>
    </div>
</header>

<main>
    <div class="container1">
        <aside>
            <form class="select">
                <select id="semesters"
                ><option>2023년 겨울학기</option
                ><option>2023년 2학기</option
                ><option>2023년 여름학기</option
                ><option>2023년 1학기</option
                ><option>2022년 겨울학기</option
                ><option>2022년 2학기</option
                ><option>2022년 여름학기</option
                ><option>2022년 1학기</option
                ><option>2021년 겨울학기</option
                ><option>2021년 2학기</option
                ><option>2021년 여름학기</option
                ><option>2021년 1학기</option
                ><option>2020년 겨울학기</option
                ><option>2020년 2학기</option
                ><option>2020년 여름학기</option
                ><option>2020년 1학기</option
                ><option>2019년 겨울학기</option
                ><option>2019년 2학기</option
                ><option>2019년 여름학기</option
                ><option>2019년 1학기</option
                ><option>2018년 겨울학기</option
                ><option>2018년 2학기</option
                ><option>2018년 여름학기</option
                ><option>2018년 1학기</option
                ><option>2017년 겨울학기</option
                ><option>2017년 2학기</option
                ><option>2017년 여름학기</option
                ><option>2017년 1학기</option
                ><option>2016년 겨울학기</option
                ><option>2016년 2학기</option
                ><option>2016년 여름학기</option
                ><option>2016년 1학기</option
                ><option>2015년 겨울학기</option
                ><option>2015년 2학기</option
                ><option>2015년 여름학기</option
                ><option>2015년 1학기</option
                ><option>2014년 겨울학기</option
                ><option>2014년 2학기</option
                ><option>2014년 여름학기</option
                ><option>2014년 1학기</option
                ><option>2013년 겨울학기</option
                ><option>2013년 2학기</option
                ><option>2013년 여름학기</option
                ><option>2013년 1학기</option
                ><option>2012년 겨울학기</option
                ><option>2012년 2학기</option
                ><option>2012년 여름학기</option
                ><option>2012년 1학기</option
                ><option>2011년 겨울학기</option
                ><option>2011년 2학기</option
                ><option>2011년 여름학기</option
                ><option>2011년 1학기</option
                ><option>2010년 겨울학기</option
                ><option>2010년 2학기</option
                ><option>2010년 여름학기</option
                ><option>2010년 1학기</option></select
                >
            </form>
            <div class="current"> //현재 시간표에 대한 부분
                <p>시간표 1</p>
            </div>
            <div class="choice"> //시간표를 선택할 수 있는 부분
                <ul>
                    <a href=''><li><span>시간표1</span></li></a>
                    <a href=''><li><span>시간표2</span></li></a>
                    <a href=''><li><span>시간표3</span></li></a>
                    <a href=''><li><span>
							새 시간표 만들기
							</span></li></a>
                </ul>
            </div>
        </aside>
        <table>
            <colgroup>
                <col class="col1" />
                <col class="col2" />
                <col class="col3" />
                <col class="col4" />
                <col class="col5" />
                <col class="col6" />
                <col class="col7" />
            </colgroup>
            <tr class="thead">
                <td></td>
                <td>월</td>
                <td>화</td>
                <td>수</td>
                <td>목</td>
                <td>금</td>
                <td></td>
            </tr>
            <tr>
                <td>1교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>2교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>3교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>4교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>5교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>6교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>7교시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>

        </table>
        <button id="toggleListButton">강의 목록 열기</button>
        <div class="list">
            <!-- 강의 목록을 보여주는 부분 -->
            <div class="head">
                <!-- 태그 정보가 있는 부분 -->
                <div class="tag">
                    <div>학년</div>
                    <div>이수구분</div>
                    <div>과목번호-분반</div>
                    <div>과목명</div>
                    <div>담당교수</div>
                    <div>학점</div>
                    <div>시간</div>
                    <div>강의실/강의시간</div>
                    <div>강의평</div>
                    <div>담은 인원</div>
                </div>
                <div class="lhead">
                    <div>학년</div>
                    <div>이수구분</div>
                    <div>과목번호-분반</div>
                    <div>과목명</div>
                    <div>담당교수</div>
                    <div>학점</div>
                    <div>시간</div>
                    <div>강의실/강의시간</div>
                    <div>강의평</div>
                    <div>담은 인원</div>
                </div>
            </div>

            <div class="body">

                <!-- 강의 데이터를 반복적으로 출력 -->
                <ul id="mainList">
                    <li th:each="course : ${courses}">
                        <div th:text="${courses.departmen_id}">학년</div>
                        <div th:text="${courses.division}">이수구분</div>
                        <div th:text="${courses.courseCode}">과목번호-분반</div>
                        <div th:text="${courses.courseName}">과목명</div>
                        <div th:text="${courses.professorName}">담당교수</div>
                        <div th:text="${courses.credit}">학점</div>
                        <div th:text="${courses.start_period} + '-' + ${courses.end_period}">시간</div>
                        <div th:text="${courses.classroom}">강의실/강의시간</div>
                        <div th:text="${courses.capacity}">담은 인원</div>
                    </li>
                </ul>
            </div>
        </div>

    </div>
</main>
<script>
    // Flex box 스타일을 저장하는 배열
    const flexBox = [0.5, 0.5, 1.5, 1, 1, 1, 0.5, 3, 1, 1];

    // Toggle button과 mainList 요소를 가져옴
    const toggleButton = document.getElementById('toggleListButton');
    const list = document.querySelector('.list');
    const mainList = document.getElementById('mainList');

    // Toggle button 클릭 시 리스트 표시/숨기기
    toggleButton.addEventListener('click', function () {
        if (list.style.display === 'none' || list.style.display === '') {
            list.style.display = 'block';
            toggleButton.textContent = '강의 목록 닫기';
            loadList(); // 리스트를 불러오는 함수 호출
        } else {
            list.style.display = 'none';
            toggleButton.textContent = '강의 목록 열기';
        }
    });

    // 서버에서 데이터를 가져와서 리스트를 만드는 함수
    function loadList() {
        // Fetch API를 사용해 서버에서 강의 데이터를 가져옴
        fetch('/api/courses/list')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                console.log('Fetched data:', data);  // 데이터를 콘솔에 출력해 확인
                makeList(data); // 데이터를 받아와 리스트 생성
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    // 리스트를 동적으로 만드는 함수
    function makeList(data) {
        // 기존 리스트 초기화
        mainList.innerHTML = '';

        // 데이터를 순회하며 리스트를 동적으로 생성
        for (let j = 0; j < data.length; j++) {
            const list = document.createElement('li');
            const course = data[j]; // 현재 강의 데이터

            // 강의의 각 속성을 div에 넣어 리스트 아이템을 만듦
            Object.keys(course).forEach((key, i) => {
                const div = document.createElement('div');
                div.innerHTML = course[key]; // 속성 값을 div에 설정
                div.style.flex = flexBox[i]; // flex 스타일 적용
                list.appendChild(div); // 리스트에 추가
            });

            mainList.appendChild(list); // mainList에 리스트 추가
        }
    }
</script>

</body>
</html>